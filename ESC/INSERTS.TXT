INSERT INTO conducta VALUES  (1,)


INSERT INTO conducta VALUES (1,"Compra de votos","Cualquier persona");
INSERT INTO conducta VALUES (2,"Condicionar un servicio público","Cualquier persona");
INSERT INTO conducta VALUES (3,"Tomar INE sin consentimiento","Cualquier persona");
INSERT INTO conducta VALUES (4,"Alteración de resultados electorales","Cualquier persona");
INSERT INTO conducta VALUES (5,"Robo de casillas electorales","Cualquier persona");


INSERT INTO conducta VALUES (6,"Abuso de autoridad","Servidor/a público");
INSERT INTO conducta VALUES (7,"Condicionar un servicio público","Servidor/a público");
INSERT INTO conducta VALUES (8,"Enfoque ilícito de fondos","Servidor/a público");
INSERT INTO conducta VALUES (9,"Obstrucción fiscal","Servidor/a público");
INSERT INTO conducta VALUES (10,"Prestación ilícita de servicios","Servidor/a público");


INSERT INTO conducta VALUES (11,"Incumplimiento de labores","Funcionario/a electoral");
INSERT INTO conducta VALUES (12,"Alteración de documentos","Funcionario/a electoral");
INSERT INTO conducta VALUES (13,"Obstrucción electoral","Funcionario/a electoral");
INSERT INTO conducta VALUES (14,"Condicionar votos","Funcionario/a electoral");
INSERT INTO conducta VALUES (15,"Alteración de casillas","Funcionario/a electoral");
INSERT INTO conducta VALUES (16,"Negligencia electoral","Funcionario/a electoral");
INSERT INTO conducta VALUES (17,"Desinformación","Funcionario/a electoral");


INSERT INTO conducta VALUES (18,"Condicionar votos","Funcionario/a partidista");
INSERT INTO conducta VALUES (19,"Obstrucción de casillas","Funcionario/a partidista");
INSERT INTO conducta VALUES (20,"Obstrucción electoral","Funcionario/a partidista");
INSERT INTO conducta VALUES (21,"Compra de votos","Funcionario/a partidista");
INSERT INTO conducta VALUES (22,"Abstención de transparencia","Funcionario/a partidista");
INSERT INTO conducta VALUES (23,"Desinformación","Funcionario/a partidista");
INSERT INTO conducta VALUES (24,"Falsificación de documentos","Funcionario/a partidista");


INSERT INTO conducta VALUES (25,"Condicionar votos","Ministros/as de culto religioso");


INSERT INTO conducta VALUES (26,"Incumplimiento de labores","Diputados/as y Senadores/as electos");


INSERT INTO conducta VALUES (27,"Negación de resultados","Fedatarios/as públicos");


INSERT INTO conducta VALUES (28,"Asunción ilegal de cargo","Ex Mag E, Con E, Secretario INE");

SELECT 
    equipo.id AS id_equipo,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = equipo.id AND topos_encuentro.goles_local IS NOT NULL THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id AND topos_encuentro.goles_visitante IS NOT NULL THEN 1 ELSE NULL END) AS pj,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = equipo.id AND topos_encuentro.goles_local > topos_encuentro.goles_visitante THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id AND topos_encuentro.goles_visitante > topos_encuentro.goles_local THEN 1 ELSE NULL END) AS pg,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = equipo.id AND topos_encuentro.goles_local < topos_encuentro.goles_visitante THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id AND topos_encuentro.goles_visitante < topos_encuentro.goles_local THEN 1 ELSE NULL END) AS pp,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = equipo.id THEN topos_encuentro.goles_local ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id THEN topos_encuentro.goles_visitante ELSE 0 END) AS gf,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = equipo.id THEN topos_encuentro.goles_visitante ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id THEN topos_encuentro.goles_local ELSE 0 END) AS gc,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = equipo.id THEN topos_encuentro.goles_local ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id THEN topos_encuentro.goles_visitante ELSE 0 END) -
    SUM(CASE WHEN topos_encuentro.id_equipo_local = equipo.id THEN topos_encuentro.goles_visitante ELSE 0 END) -
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = equipo.id THEN topos_encuentro.goles_local ELSE 0 END) AS dg
FROM 
    topos_encuentro
JOIN
    (
        SELECT id_equipo_local AS id FROM topos_encuentro WHERE goles_local IS NOT NULL
        UNION
        SELECT id_equipo_visitante AS id FROM topos_encuentro WHERE goles_visitante IS NOT NULL
    ) AS equipo
ON 
    equipo.id IN (topos_encuentro.id_equipo_local, topos_encuentro.id_equipo_visitante)
GROUP BY 
    equipo.id
ORDER BY 
    pg DESC, dg DESC, gf DESC;


SELECT 
    topos_equipo.nombre_equipo AS nombre_equipo,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo AND topos_encuentro.goles_local IS NOT NULL THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo AND topos_encuentro.goles_visitante IS NOT NULL THEN 1 ELSE NULL END) AS pj,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo AND topos_encuentro.goles_local > topos_encuentro.goles_visitante THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo AND topos_encuentro.goles_visitante > topos_encuentro.goles_local THEN 1 ELSE NULL END) AS pg,
    COUNT(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo AND topos_encuentro.goles_local < topos_encuentro.goles_visitante THEN 1 ELSE NULL END) +
    COUNT(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo AND topos_encuentro.goles_visitante < topos_encuentro.goles_local THEN 1 ELSE NULL END) AS pp,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo THEN topos_encuentro.goles_local ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo THEN topos_encuentro.goles_visitante ELSE 0 END) AS gf,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo THEN topos_encuentro.goles_visitante ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo THEN topos_encuentro.goles_local ELSE 0 END) AS gc,
    SUM(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo THEN topos_encuentro.goles_local ELSE 0 END) +
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo THEN topos_encuentro.goles_visitante ELSE 0 END) -
    SUM(CASE WHEN topos_encuentro.id_equipo_local = topos_equipo.id_equipo THEN topos_encuentro.goles_visitante ELSE 0 END) -
    SUM(CASE WHEN topos_encuentro.id_equipo_visitante = topos_equipo.id_equipo THEN topos_encuentro.goles_local ELSE 0 END) AS dg
FROM 
    topos_encuentro
JOIN
    topos_equipo
ON 
    topos_equipo.id_equipo = topos_encuentro.id_equipo_local OR topos_equipo.id_equipo = topos_encuentro.id_equipo_visitante
GROUP BY 
    topos_equipo.id_equipo, topos_equipo.nombre_equipo
ORDER BY 
    pg DESC, dg DESC, gf DESC;



ocupacion sin obligatorio

direccion





